<html>
    <head>
        <h1 style="background-color:DodgerBlue;">
        <p style="text-align:center">
        <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
    </head>

    <body>
       
        <input type=  "file" id="input">
    </h1>
    <h1 style="color:MediumSeaGreen;">
        <table id="tbl-data"></table>
    
        <script>
            var input = document.getElementById('input');
            input.addEventListener('change', function(){
                readXlsxFile(input.files[0]).then(function(data) {
                    var i=0;
                    data.map((row, index)=> {
                        if(i==0) {
                            let table=document.getElementById('tbl-data');
                            generateTableHead(table, row);
                        }

                        if(i>0) {
                            let table=document.getElementById('tbl-data');
                            generateTableRows(table, row);
                        }

                        i++;
                    });
                });
            });

            function generateTableHead(table, data) {
                let thread = table.createTHead();
                let row= thread.insertRow();
                for(let key of data) {
                    let th = document.createElement('th');
                    let text = document.createTextNode(key);
                    th.appendChild(text);
                    row.appendChild(th);
                }
            }

            function generateTableRows(table, data) {
                let newRow= table.insertRow(-1);
                data.map((row, index)=> {
                    let newCell = newRow.insertCell();
                    let newText = document.createTextNode(row);
                    newCell.appendChild(newText);
                });
            }
        
        </script>
        </h1>
        </p>
    

        <form>
            <form>
                <h1 style="background-color:DodgerBlue;">

                <p style="text-align:center">
                <input type="button" value="Download" onClick="window.location.href='https://github.com/NehaSinguluri/data/blob/a3c528cf1ef5fb808af66660bd64b2b6dfb13761/assignement.xlsx'">
            </form>
        </p>
    </h1>
    </body>
</html>
